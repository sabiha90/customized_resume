let sampleJson = {
        "fontFamily":"Helvetica",
        "fontSize":14,
        "color":"#0072b1",
        "resumeSection":{
            "gap": 8,
            "headerRelativeFontSize":1.25,
            "headerUpperCase":true
        },
        "resumeSubSection":{
            "gap": 8,
            "titleRelativeFontSize":1.25,
            "subTitleRelativeFontSize":1.25
        },
        "name":{
            "text":"Name",
            "relativeFontSize":2.25,
            "bold":true,
            "italics":false
        },
        "title":{
            "text":"",
            "relativeFontSize":1.25,
            "bold":false,
            "italics":false
        },    
        "contact_info":{
            "email":"email@gmail.com",
            "phone":"+1 (000) 000-0000",
            "location":"City",
            "github":"github-id",
            "linkedin":"linkedin-id"
        },
        "sections":[
            {
                "title":{
                    "text":"Work Experience",
                    "bold":true,
                    "italics":false
                },
                "sub_sections":[
                    {
                        "heading":{
                            "left":{
                                "text":"Company",
                                "bold":true,
                                "italics":false
                            },
                            "center":{
                                "text":"",
                                "bold":false,
                                "italics":false
                            },
                            "right":{
                                "text":"Location",
                                "bold":true,
                                "italics":false
                            }
                        },
                        "sub_heading":{
                            "left":{
                                "text":"Job Title",
                                "bold":false,
                                "italics":true
                            },
                            "center":{
                                "text":"",
                                "bold":false,
                                "italics":false
                            },
                            "right":{
                                "text":"Time Period",
                                "bold":false,
                                "italics":false
                            }
                        },
                        "desc":"Job desc, duties, etc -etc - etc",
                        "bullets":true,
                        "bullets_column": 1,
                        "points":[
                            "bullet point - bullet point - bullet point - bullet point - bullet point - bullet point - bullet point - bullet point - bullet point.",
                            "bullet point - bullet point - bullet point - bullet point - bullet point - bullet point - bullet point - bullet point - bullet point.",
                            "bullet point - bullet point - bullet point - bullet point - bullet point - bullet point - bullet point - bullet point - bullet point.",
                            "bullet point - bullet point - bullet point - bullet point - bullet point - bullet point - bullet point - bullet point - bullet point."
                        ]
                    },
                    {
                        "heading":{
                            "left":{
                                "text":"Company",
                                "bold":true,
                                "italics":false
                            },
                            "center":{
                                "text":"",
                                "bold":false,
                                "italics":false
                            },
                            "right":{
                                "text":"Location",
                                "bold":true,
                                "italics":false
                            }
                        },
                        "sub_heading":{
                            "left":{
                                "text":"Job Title",
                                "bold":false,
                                "italics":true
                            },
                            "center":{
                                "text":"",
                                "bold":false,
                                "italics":false
                            },
                            "right":{
                                "text":"Time Period",
                                "bold":false,
                                "italics":false
                            }
                        },
                        "desc":"Job desc, duties, etc -etc - etc",
                        "bullets":true,
                        "bullets_column": 1,
                        "points":[
                            "bullet point - bullet point - bullet point - bullet point - bullet point - bullet point - bullet point - bullet point - bullet point.",
                            "bullet point - bullet point - bullet point - bullet point - bullet point - bullet point - bullet point - bullet point - bullet point.",
                            "bullet point - bullet point - bullet point - bullet point - bullet point - bullet point - bullet point - bullet point - bullet point.",
                            "bullet point - bullet point - bullet point - bullet point - bullet point - bullet point - bullet point - bullet point - bullet point."
                        ]
                    }
                ]
            },
            {
                "title":{
                    "text":"Skills",
                    "bold":true,
                    "italics":false
                },
                "sub_sections":[
                    {
                        "heading":{
                            "left":{
                                "text":"",
                                "bold":false,
                                "italics":false
                            },
                            "center":{
                                "text":"",
                                "bold":false,
                                "italics":false
                            },
                            "right":{
                                "text":"",
                                "bold":false,
                                "italics":false
                            }
                        },
                        "sub_heading":{
                            "left":{
                                "text":"",
                                "bold":false,
                                "italics":false
                            },
                            "center":{
                                "text":"",
                                "bold":false,
                                "italics":false
                            },
                            "right":{
                                "text":"",
                                "bold":false,
                                "italics":false
                            }
                        },
                        "desc":"",
                        "bullets":false,
                        "bullets_column": 2,
                        "points":[
                            "<b>Col:</b> Skills skills skills skills skills",
                            "<b>Col:</b> Skills skills skills skills skills"
                        ]
                    }
                ]
            },
            {
                "title":{
                    "text":"Projects",
                    "bold":true,
                    "italics":false
                },
                "sub_sections":[
                    {
                        "heading":{
                            "left":{
                                "text":"",
                                "bold":false,
                                "italics":false
                            },
                            "center":{
                                "text":"",
                                "bold":false,
                                "italics":false
                            },
                            "right":{
                                "text":"",
                                "bold":false,
                                "italics":false
                            }
                        },
                        "sub_heading":{
                            "left":{
                                "text":"",
                                "bold":false,
                                "italics":false
                            },
                            "center":{
                                "text":"",
                                "bold":false,
                                "italics":false
                            },
                            "right":{
                                "text":"",
                                "bold":false,
                                "italics":false
                            }
                        },
                        "desc":"",
                        "bullets":true,
                        "bullets_column": 1,
                        "points":[
                            "Project description - achievement. Project description - achievement. Project description - achievement. Project description - achievement. Project description - achievement.",
                            "Project description - achievement. Project description - achievement. Project description - achievement. Project description - achievement. Project description - achievement."
                        ]
                    }
                ]
            },
            {
                "title":{
                    "text":"Education",
                    "bold":true,
                    "italics":false
                },
                "sub_sections":[
                    {
                        "heading":{
                            "left":{
                                "text":"Institute",
                                "bold":false,
                                "italics":false
                            },
                            "center":{
                                "text":"Degree",
                                "bold":false,
                                "italics":false
                            },
                            "right":{
                                "text":"Location",
                                "bold":false,
                                "italics":false
                            }
                        },
                        "sub_heading":{
                            "left":{
                                "text":"",
                                "bold":false,
                                "italics":false
                            },
                            "center":{
                                "text":"",
                                "bold":false,
                                "italics":false
                            },
                            "right":{
                                "text":"",
                                "bold":false,
                                "italics":false
                            }
                        },
                        "desc":"",
                        "bullets":true,
                        "bullets_column": 1,
                        "points":[
                            "achievements at institute. achievements at institute. achievements at institute. achievements at institute.",
                            "achievements at institute. achievements at institute. achievements at institute. achievements at institute."
                        ]
                    },
                    {
                        "heading":{
                            "left":{
                                "text":"Institute",
                                "bold":false,
                                "italics":false
                            },
                            "center":{
                                "text":"Degree",
                                "bold":false,
                                "italics":false
                            },
                            "right":{
                                "text":"Location",
                                "bold":false,
                                "italics":false
                            }
                        },
                        "sub_heading":{
                            "left":{
                                "text":"",
                                "bold":false,
                                "italics":false
                            },
                            "center":{
                                "text":"",
                                "bold":false,
                                "italics":false
                            },
                            "right":{
                                "text":"",
                                "bold":false,
                                "italics":false
                            }
                        },
                        "desc":"",
                        "bullets":true,
                        "bullets_column": 1,
                        "points":[
                            "achievements at institute. achievements at institute. achievements at institute. achievements at institute.",
                            "achievements at institute. achievements at institute. achievements at institute. achievements at institute."
                        ]
                    }
                ]
            },
            {
                "title":{
                    "text":"Publications",
                    "bold":true,
                    "italics":false
                },
                "sub_sections":[
                    {
                        "heading":{
                            "left":{
                                "text":"",
                                "bold":false,
                                "italics":false
                            },
                            "center":{
                                "text":"",
                                "bold":false,
                                "italics":false
                            },
                            "right":{
                                "text":"",
                                "bold":false,
                                "italics":false
                            }
                        },
                        "sub_heading":{
                            "left":{
                                "text":"",
                                "bold":false,
                                "italics":false
                            },
                            "center":{
                                "text":"",
                                "bold":false,
                                "italics":false
                            },
                            "right":{
                                "text":"",
                                "bold":false,
                                "italics":false
                            }
                        },
                        "desc":"",
                        "bullets":true,
                        "bullets_column": 1,
                        "points":[
                            "Publications - publications - Publications - publications - Publications - publications - Publications - publications - Publications - publications",
                            "Publications - publications - Publications - publications - Publications - publications - Publications - publications - Publications - publications"
                        ]
                    }
                ]
            }
        ]
    };

function saveToPdf(){
    let bodyElem = d3.select('body'),
        resumeElem = d3.select('#resume_div'),
        textElem = d3.select('#json_text'),
        jsonContent = textElem.property("value"),
        restorePage = bodyElem.html(),
        printContent = resumeElem.html();
    
    bodyElem.selectAll("*").remove();
    bodyElem.html(printContent);
    window.print();
    bodyElem.html(restorePage);

    // get reference to text area and resume elem again
    textElem = d3.select('#json_text');
    resumeElem = d3.select('#resume_div'),
    textElem.property("value", jsonContent);
}

function bodyLoaded(){
    let textElem = d3.select('#json_text');
    textElem.property("value", JSON.stringify(sampleJson, null, '\t'));
}

function updateResume(){
    let resumeElem = d3.select('#resume_div'),
        textElem = d3.select('#json_text'),
        jsonContent = textElem.property("value"),
        resumeJson = JSON.parse(jsonContent);

    // clear everything from resume elem
    resumeElem.selectAll("*").remove();

    //add high level formats
    resumeElem.style('font-size', resumeJson.fontSize)
                .style('font-family', resumeJson.fontFamily);

    // add header
    let headerDiv = resumeElem.append('div').attr('id', 'header');

    headerDiv.append('p')
                .attr('id', 'resume_name')
                .style('font-size', resumeJson.name.relativeFontSize + 'em')
                .style('color', resumeJson.color)
                .style('font-weight', resumeJson.name.bold ? 'bold' : 'normal')
                .style('font-style', resumeJson.name.italics ? 'italic' : 'normal')
                .text(resumeJson.name.text);

    if(resumeJson.title.text){
        // add title
        headerDiv.append('p')
                .attr('id', 'resume_title')
                .style('font-size', resumeJson.title.relativeFontSize + 'em')
                .style('color', resumeJson.color)
                .style('font-weight', resumeJson.title.bold ? 'bold' : 'normal')
                .style('font-style', resumeJson.title.italics ? 'italic' : 'normal')
                .text(resumeJson.title.text);
    }

    // add contacts
    let contactsDiv = headerDiv.append('div').attr('id','contacts_div');
    let contactDiv;
    if(resumeJson.contact_info.email){
        contactDiv = contactsDiv.append('div').attr('class', 'contact_div');
        contactDiv.append('span')
                    .attr('class', 'envelope_icon')
                    .append('span')
                        .attr('class', 'fa fa-envelope')
                        .style('color', resumeJson.color);

        contactDiv.append('span')
                    .attr('class', 'contact')
                    .append('a')
                        .attr('href', 'mailto:' + resumeJson.contact_info.email)
                        .style('color', resumeJson.color)
                        .text(resumeJson.contact_info.email);
    }

    if(resumeJson.contact_info.phone){
        contactDiv = contactsDiv.append('div').attr('class', 'contact_div');
        contactDiv.append('span')
                    .attr('class', 'mobile_icon')
                    .append('span')
                        .attr('class', 'fa fa-mobile')
                        .style('color', resumeJson.color);

        contactDiv.append('span')
                    .attr('class', 'contact')
                    .style('color', resumeJson.color)
                    .text(resumeJson.contact_info.phone);
    }

    if(resumeJson.contact_info.location){
        contactDiv = contactsDiv.append('div').attr('class', 'contact_div');
        contactDiv.append('span')
                    .attr('class', 'map_icon')
                    .append('span')
                        .attr('class', 'fa fa-map-marker')
                        .style('color', resumeJson.color);

        contactDiv.append('span')
                    .attr('class', 'contact')
                    .style('color', resumeJson.color)
                    .text(resumeJson.contact_info.location);
    }

    if(resumeJson.contact_info.github){
        contactDiv = contactsDiv.append('div').attr('class', 'contact_div');
        contactDiv.append('span')
                    .attr('class', 'github_icon')
                    .append('span')
                        .attr('class', 'fa fa-github')
                        .style('color', resumeJson.color);

        contactDiv.append('span')
                    .attr('class', 'contact')
                    .append('a')
                        .attr('href', 'https://github.com/' + resumeJson.contact_info.github)
                        .style('color', resumeJson.color)
                        .text(resumeJson.contact_info.github);
    }

    if(resumeJson.contact_info.linkedin){
        contactDiv = contactsDiv.append('div').attr('class', 'contact_div');
        contactDiv.append('span')
                    .attr('class', 'envelope_icon')
                    .append('span')
                        .attr('class', 'fa fa-envelope')
                        .style('color', resumeJson.color);

        contactDiv.append('span')
                    .attr('class', 'contact')
                    .append('a')
                        .attr('href', 'https://www.linkedin.com/in/' + resumeJson.contact_info.linkedin)
                        .style('color', resumeJson.color)
                        .text(resumeJson.contact_info.linkedin);
    }

    // add sections
    resumeJson.sections.forEach(function(section){
        let sectionElem = resumeElem.append('div')
                                    .attr('class', 'resume_section')
                                    .style('margin', resumeJson.resumeSection.gap + ' 0');
        // add section header
        sectionElem.append('div').attr('class', 'section_header')
                    .append('p')
                    .style('color', resumeJson.color)
                    .style('font-weight', section.title.bold ? 'bold' : 'normal')
                    .style('font-style', section.title.italics ? 'italic' : 'normal')
                    .style('font-size', resumeJson.resumeSection.headerRelativeFontSize + 'em')
                    .style('text-transform', resumeJson.resumeSection.headerUpperCase ? 'uppercase' : 'none')
                    .text(section.title.text);

        sectionElem.append('hr').style('background-color', resumeJson.color);

        // add sub-sections
        section.sub_sections.forEach(function(subSection){
            let subSectionElem = sectionElem.append('div')
                                            .attr('class', 'section_content')
                                            .style('margin', resumeJson.resumeSubSection.gap + ' 0');

            let subSectionHeadingPresent = subSection.heading.left.text || subSection.heading.center.text || subSection.heading.right.text;
            let subSectionSubHeadingPresent = subSection.sub_heading.left.text || subSection.sub_heading.center.text || subSection.sub_heading.right.text;
            // add sub section heading
            if(subSectionHeadingPresent){
                let subSectionHeadingDiv = subSectionElem.append('div')
                                                            .style('display', 'flex')
                                                            .style('justify-content', 'space-between');
                if(subSection.heading.left.text){
                    subSectionHeadingDiv.append('span')
                                    .style('font-weight', subSection.heading.left.bold ? 'bold' : 'normal')
                                    .style('font-style', subSection.heading.left.italics ? 'italic' : 'normal')
                                    .style('font-size', resumeJson.resumeSubSection.headerRelativeFontSize + 'em')
                                    .text(subSection.heading.left.text);
                }
                if(subSection.heading.center.text){
                    subSectionHeadingDiv.append('span')
                                    .style('font-weight', subSection.heading.center.bold ? 'bold' : 'normal')
                                    .style('font-style', subSection.heading.center.italics ? 'italic' : 'normal')
                                    .style('text-align', 'center')
                                    .style('font-size', resumeJson.resumeSubSection.headerRelativeFontSize + 'em')
                                    .text(subSection.heading.center.text);
                }
                if(subSection.heading.right.text){
                    subSectionHeadingDiv.append('span')
                                    .style('font-weight', subSection.heading.right.bold ? 'bold' : 'normal')
                                    .style('font-style', subSection.heading.right.italics ? 'italic' : 'normal')
                                    .style('text-align', 'right')
                                    .style('font-size', resumeJson.resumeSubSection.headerRelativeFontSize + 'em')
                                    .text(subSection.heading.right.text);
                }
            }

            // add sub section sub heading
            if(subSectionSubHeadingPresent){
                let subSectionSubHeadingDiv = subSectionElem.append('div')
                                                            .style('display', 'flex')
                                                            .style('justify-content', 'space-between');
                if(subSection.sub_heading.left.text){
                    subSectionSubHeadingDiv.append('span')
                                    .style('font-weight', subSection.sub_heading.left.bold ? 'bold' : 'normal')
                                    .style('font-style', subSection.sub_heading.left.italics ? 'italic' : 'normal')
                                    .style('font-size', resumeJson.resumeSubSection.subTitleRelativeFontSize + 'em')
                                    .text(subSection.sub_heading.left.text);
                }
                if(subSection.sub_heading.center.text){
                    subSectionSubHeadingDiv.append('span')
                                    .style('font-weight', subSection.sub_heading.center.bold ? 'bold' : 'normal')
                                    .style('font-style', subSection.sub_heading.center.italics ? 'italic' : 'normal')
                                    .style('text-align', 'center')
                                    .style('font-size', resumeJson.resumeSubSection.subTitleRelativeFontSize + 'em')
                                    .text(subSection.sub_heading.center.text);
                }
                if(subSection.sub_heading.right.text){
                    subSectionSubHeadingDiv.append('span')
                                    .style('font-weight', subSection.sub_heading.right.bold ? 'bold' : 'normal')
                                    .style('font-style', subSection.sub_heading.right.italics ? 'italic' : 'normal')
                                    .style('text-align', 'right')
                                    .style('font-size', resumeJson.resumeSubSection.subTitleRelativeFontSize + 'em')
                                    .text(subSection.sub_heading.right.text);
                }
            }

            // add sub section description
            if(subSection.desc){
                subSectionElem.append('p')
                                .text(subSection.desc);
            }

            // sub section points
            if(subSection.points){
                let bulletsDiv = subSectionElem.append('div');
                let activeDiv, firstDiv, secondDiv, ulElem, firstUl, secondUl;
                if(subSection.bullets_column == 2){
                    bulletsDiv.style('display', 'flex');
                    firstDiv = bulletsDiv.append('div')
                                            .style('width', '50%');
                    secondDiv = bulletsDiv.append('div')
                                            .style('width', '50%');                      
                }

                if(subSection.bullets){
                    if(subSection.bullets_column == 2){
                        firstUl = firstDiv.append('ul');
                        secondUl = secondDiv.append('ul');
                    }else{
                        ulElem =  bulletsDiv.append('ul');
                    }
                    subSection.points.forEach(function(point, i){
                        if(subSection.bullets_column == 2){
                            ulElem = i%2 ? secondUl : firstUl;
                        }
                        ulElem.append('li').html(point);
                    });
                }else{
                    activeDiv =  bulletsDiv;
                    subSection.points.forEach(function(point, i){
                        if(subSection.bullets_column == 2){
                            activeDiv = i%2 ? secondDiv : firstDiv;
                        }
                        activeDiv.append('p').html(point);
                    });
                }
                
            }
        });
    });
}